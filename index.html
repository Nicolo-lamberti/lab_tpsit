<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anagrafica</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .portfolio-icon {
            width: 24px;
            height: 24px;
            cursor: pointer;
        }
    </style>
</head>
<body class="bg-light">
    <div class="container py-5">
        <h1 class="text-center mb-4">Anagrafica</h1>
        
        <!-- Tabella JSON -->
        <h2 class="mb-3">Dati JSON</h2>
        <table class="table table-striped table-hover">
            <thead class="table-dark">
                <tr>
                    <th>Nome</th>
                    <th>Cognome</th>
                    <th>Età</th>
                    <th>Indirizzo</th>
                    <th>Città</th>
                    <th>Telefono</th>
                    <th>Portfolio</th>
                </tr>
            </thead>
            <tbody id="anagraficaTable"></tbody>
        </table>
    </div>

    <script>
        // Funzione per caricare i dati JSON tramite XMLHttpRequest
        var xhr = new XMLHttpRequest();
        xhr.open("GET", "anagrafica.json", true);  // Imposta la richiesta per caricare il file JSON
        xhr.onreadystatechange = function() {
            // Quando la richiesta è completata
            if (xhr.readyState === 4) {
                if (xhr.status === 200) {
                    // Se il file è caricato correttamente, parse dei dati JSON
                    var data = JSON.parse(xhr.responseText);
                    var table = document.querySelector("#anagraficaTable");

                    // Verifica se i dati sono validi e contiene almeno un elemento
                    if (Array.isArray(data) && data.length > 0) {
                        data.forEach(persona => {
                            // Crea una nuova riga nella tabella per ogni persona
                            var row = table.insertRow();
                            row.insertCell(0).textContent = persona.Nome || 'Non disponibile'; // Nome
                            row.insertCell(1).textContent = persona.Cognome || 'Non disponibile'; // Cognome
                            row.insertCell(2).textContent = persona.Eta || 'Non disponibile'; // Età
                            row.insertCell(3).textContent = persona.Indirizzo || 'Non disponibile'; // Indirizzo
                            row.insertCell(4).textContent = persona.Citta || 'Non disponibile'; // Città
                            row.insertCell(5).textContent = persona.Telefono || 'Non disponibile'; // Telefono

                            // Aggiungi una cella per l'icona del portfolio
                            var portfolioCell = row.insertCell(6);
                            var link = document.createElement("a");

                            // Se esiste il portfolio, crea il link con il nome del file
                            if (persona.Portfolio) {
                                // Codifica il nome del file per evitare problemi con caratteri speciali
                                link.href = `portfolio.html?file=${encodeURIComponent(persona.Portfolio)}`;
                                link.target = "_blank";  // Apre il link in una nuova finestra
                            } else {
                                // Se il portfolio non è presente, disabilita il link
                                link.href = "#";
                                link.classList.add("disabled");
                            }

                            // Crea l'icona per il portfolio
                            var icon = document.createElement("img");
                            icon.src = "portfolio-icon.png"; // Percorso dell'icona
                            icon.alt = "Portfolio";  // Descrizione per l'icona
                            icon.className = "portfolio-icon";  // Aggiunge la classe per la dimensione

                            // Aggiungi l'icona al link e il link alla cella
                            link.appendChild(icon);
                            portfolioCell.appendChild(link);
                        });
                    } else {
                        alert("Dati JSON non validi."); // Se i dati non sono corretti
                    }
                } else {
                    alert("Errore nel caricamento del file JSON: " + xhr.status);  // Se c'è un errore nel caricamento
                }
            }
        };
        xhr.send();  // Invia la richiesta per caricare il file JSON
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
